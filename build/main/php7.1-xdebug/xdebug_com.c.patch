--- a/xdebug_com.c
+++ b/xdebug_com.c
@@ -23,7 +23,11 @@
 #include <stdio.h>
 #include <fcntl.h>
 #ifndef PHP_WIN32
-# include <sys/poll.h>
+# if HAVE_POLL_H
+#  include <poll.h>
+# elif HAVE_SYS_POLL_H
+#  include <sys/poll.h>
+# endif
 # include <unistd.h>
 # include <sys/socket.h>
 # include <netinet/tcp.h>
